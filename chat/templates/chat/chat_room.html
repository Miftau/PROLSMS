{% extends 'base.html' %}
{% block content %}
<h3>Chat Room: {{ room.name }}</h3>
<div id="chat-box" style="height:300px; overflow-y:scroll; border:1px solid #ccc; padding:10px;"></div>
<input id="chat-message-input" type="text" class="form-control mt-2" placeholder="Type a message">
<button class="btn btn-primary mt-2" onclick="sendMessage()">Send</button>

<script>
  const socket = new WebSocket('ws://' + window.location.host + '/ws/chat/{{ room.id }}/');
  
  socket.onmessage = function(e) {
    const data = JSON.parse(e.data);
    const chatBox = document.getElementById('chat-box');
    chatBox.innerHTML += `<div><b>${data.username}:</b> ${data.message}</div>`;
  };

  function sendMessage() {
    const input = document.getElementById('chat-message-input');
    socket.send(JSON.stringify({ message: input.value }));
    input.value = '';
  }
</script>
{% endblock %}
